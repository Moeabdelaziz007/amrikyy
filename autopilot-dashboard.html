<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AuraOS Autopilot Dashboard - لوحة التحكم الطيار الآلي</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#00d9ff">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="AuraOS Autopilot">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="autopilot-dashboard.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Chart.js for Analytics -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script defer src="/live-widgets.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
</head>
<body class="autopilot-dashboard">
    <!-- Header -->
    <header class="autopilot-header">
        <div class="header-content">
            <div class="header-brand">
                <i class="fas fa-robot"></i>
                <span>AuraOS Autopilot</span>
                <span class="status-indicator online">متصل</span>
            </div>
            <div class="header-controls">
                <button class="control-btn" id="darkModeToggle">
                    <i class="fas fa-moon"></i>
                    الوضع الداكن
                </button>
                <button class="control-btn" id="refreshBtn">
                    <i class="fas fa-sync-alt"></i>
                    تحديث
                </button>
                <button class="control-btn" id="settingsBtn">
                    <i class="fas fa-cog"></i>
                    إعدادات
                </button>
                <button class="control-btn" id="languageToggle">
                    <i class="fas fa-language"></i>
                    EN
                </button>
            </div>
        </div>
    </header>

    <!-- Main Dashboard -->
    <main class="dashboard-main">
        <!-- System Status Overview -->
        <section class="status-overview">
            <div class="status-card">
                <div class="status-icon">
                    <i class="fas fa-tasks"></i>
                </div>
                <div class="status-info">
                    <h3>المهام النشطة</h3>
                    <span class="status-number" id="activeTasks">0</span>
                    <span class="status-subtitle">مهمة قيد التنفيذ</span>
                </div>
            </div>
            
            <div class="status-card">
                <div class="status-icon">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="status-info">
                    <h3>قائمة الانتظار</h3>
                    <span class="status-number" id="queuedTasks">0</span>
                    <span class="status-subtitle">مهمة في الانتظار</span>
                </div>
            </div>
            
            <div class="status-card">
                <div class="status-icon">
                    <i class="fas fa-check-circle"></i>
                </div>
                <div class="status-info">
                    <h3>معدل النجاح</h3>
                    <span class="status-number" id="successRate">0%</span>
                    <span class="status-subtitle">نجح في التنفيذ</span>
                </div>
            </div>
            
            <div class="status-card">
                <div class="status-icon">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="status-info">
                    <h3>الوكلاء النشطة</h3>
                    <span class="status-number" id="activeAgents">0</span>
                    <span class="status-subtitle">وكيل متصل</span>
                </div>
            </div>
        </section>

        <!-- Real-time Task Queue -->
        <section class="task-queue-section glass-card" id="card-queue">
            <div class="card-controls">
                <button class="overlay-btn" data-action="play" title="تشغيل"><i class="fas fa-play"></i></button>
                <button class="overlay-btn" data-action="stop" title="إيقاف"><i class="fas fa-stop"></i></button>
                <button class="overlay-btn" data-action="refresh" title="تحديث"><i class="fas fa-rotate-right"></i></button>
                <button class="overlay-btn" data-action="emergency" title="طوارئ"><i class="fas fa-triangle-exclamation"></i></button>
            </div>
            <div class="section-header">
                <h2><i class="fas fa-list"></i> قائمة المهام المباشرة</h2>
                <div class="queue-controls">
                    <button class="queue-btn" id="pauseQueue">
                        <i class="fas fa-pause"></i>
                        إيقاف مؤقت
                    </button>
                    <button class="queue-btn" id="clearQueue">
                        <i class="fas fa-trash"></i>
                        مسح القائمة
                    </button>
                </div>
            </div>
            
            <div class="task-queue-container">
                <div class="queue-header">
                    <span>المهمة</span>
                    <span>النوع</span>
                    <span>الوكيل</span>
                    <span>الأولوية</span>
                    <span>الحالة</span>
                    <span>التقدم</span>
                </div>
                <div class="queue-list" id="taskQueueList">
                    <!-- Tasks will be populated here -->
                </div>
            </div>
        </section>

        <!-- Agent Management -->
        <section class="agent-management glass-card" id="card-agents">
            <div class="card-controls">
                <button class="overlay-btn" data-action="play" title="تشغيل"><i class="fas fa-play"></i></button>
                <button class="overlay-btn" data-action="stop" title="إيقاف"><i class="fas fa-stop"></i></button>
                <button class="overlay-btn" data-action="refresh" title="تحديث"><i class="fas fa-rotate-right"></i></button>
                <button class="overlay-btn" data-action="emergency" title="طوارئ"><i class="fas fa-triangle-exclamation"></i></button>
            </div>
            <div class="section-header">
                <h2><i class="fas fa-cogs"></i> إدارة الوكلاء</h2>
                <button class="add-agent-btn" id="addAgentBtn">
                    <i class="fas fa-plus"></i>
                    إضافة وكيل
                </button>
            </div>
            
            <div class="agents-grid" id="agentsGrid">
                <!-- Agents will be populated here -->
            </div>
        </section>

        <!-- Performance Analytics -->
        <section class="analytics-section glass-card" id="card-analytics">
            <div class="card-controls">
                <button class="overlay-btn" data-action="play" title="تشغيل"><i class="fas fa-play"></i></button>
                <button class="overlay-btn" data-action="stop" title="إيقاف"><i class="fas fa-stop"></i></button>
                <button class="overlay-btn" data-action="refresh" title="تحديث"><i class="fas fa-rotate-right"></i></button>
                <button class="overlay-btn" data-action="emergency" title="طوارئ"><i class="fas fa-triangle-exclamation"></i></button>
            </div>
            <div class="section-header">
                <h2><i class="fas fa-chart-line"></i> التحليلات والأداء</h2>
                <div class="analytics-controls">
                    <select id="timeRange">
                        <option value="1h">آخر ساعة</option>
                        <option value="6h">آخر 6 ساعات</option>
                        <option value="24h">آخر 24 ساعة</option>
                        <option value="7d">آخر 7 أيام</option>
                    </select>
                </div>
            </div>
            
            <div class="analytics-grid">
                <div class="chart-container">
                    <h3>الموارد الحية</h3>
                    <div id="live-system-chart" style="height:220px;border:1px solid #1f2937;border-radius:12px;"></div>
                </div>
                <div class="chart-container">
                    <h3>حجم المهام</h3>
                    <canvas id="taskVolumeChart"></canvas>
                </div>
                
                <div class="chart-container">
                    <h3>أداء الوكلاء</h3>
                    <canvas id="agentPerformanceChart"></canvas>
                </div>
                
                <div class="chart-container">
                    <h3>معدل النجاح</h3>
                    <canvas id="successRateChart"></canvas>
                </div>
                
                <div class="chart-container">
                    <h3>وقت الاستجابة</h3>
                    <canvas id="responseTimeChart"></canvas>
                </div>
            </div>
        </section>

        <!-- System Logs -->
        <section class="logs-section">
            <div class="section-header">
                <h2><i class="fas fa-file-alt"></i> سجلات النظام</h2>
                <div class="logs-controls">
                    <select id="logLevel">
                        <option value="all">جميع المستويات</option>
                        <option value="info">معلومات</option>
                        <option value="warning">تحذيرات</option>
                        <option value="error">أخطاء</option>
                    </select>
                    <button class="logs-btn" id="clearLogs">
                        <i class="fas fa-trash"></i>
                        مسح السجلات
                    </button>
                </div>
            </div>
            
            <div class="logs-container">
                <div class="logs-list" id="systemLogs">
                    <!-- Logs will be populated here -->
                </div>
            </div>
        </section>
    </main>

    <!-- Task Creation Modal -->
    <div class="modal" id="taskModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>إنشاء مهمة جديدة</h3>
                <button class="modal-close" id="closeTaskModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="taskForm">
                    <div class="form-group">
                        <label for="taskType">نوع المهمة</label>
                        <select id="taskType" required>
                            <option value="data_analysis">تحليل البيانات</option>
                            <option value="web_scraping">استخراج البيانات</option>
                            <option value="automation">أتمتة</option>
                            <option value="ai_task">مهمة ذكاء اصطناعي</option>
                            <option value="general">عام</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="taskContent">محتوى المهمة</label>
                        <textarea id="taskContent" placeholder="اكتب تفاصيل المهمة هنا..." required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="taskPriority">الأولوية</label>
                        <select id="taskPriority">
                            <option value="low">منخفضة</option>
                            <option value="medium" selected>متوسطة</option>
                            <option value="high">عالية</option>
                            <option value="urgent">عاجلة</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="assignedAgent">الوكيل المخصص (اختياري)</label>
                        <select id="assignedAgent">
                            <option value="">تلقائي</option>
                            <option value="gemini_ai">Gemini AI</option>
                            <option value="httpie_agent">HTTPie Agent</option>
                            <option value="jq_agent">JQ Agent</option>
                            <option value="automation_agent">Automation Agent</option>
                            <option value="file_agent">File Agent</option>
                            <option value="voice_processing_agent">Voice Agent</option>
                            <option value="image_processing_agent">Image Agent</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancelTask">إلغاء</button>
                <button type="submit" class="btn btn-primary" id="createTask">إنشاء المهمة</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>إعدادات النظام</h3>
                <button class="modal-close" id="closeSettingsModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="settings-tabs">
                    <button class="tab-btn active" data-tab="general">عام</button>
                    <button class="tab-btn" data-tab="agents">الوكلاء</button>
                    <button class="tab-btn" data-tab="notifications">الإشعارات</button>
                </div>
                
                <div class="settings-content">
                    <div class="tab-content active" id="general">
                        <div class="setting-item">
                            <label>اللغة</label>
                            <select id="systemLanguage">
                                <option value="ar">العربية</option>
                                <option value="en">English</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label>معدل التحديث (ثانية)</label>
                            <input type="number" id="refreshRate" value="5" min="1" max="60">
                        </div>
                    </div>
                    
                    <div class="tab-content" id="agents">
                        <div class="agent-settings">
                            <!-- Agent settings will be populated here -->
                        </div>
                    </div>
                    
                    <div class="tab-content" id="notifications">
                        <div class="setting-item">
                            <label>
                                <input type="checkbox" id="telegramNotifications" checked>
                                إشعارات Telegram
                            </label>
                        </div>
                        <div class="setting-item">
                            <label>
                                <input type="checkbox" id="emailNotifications">
                                إشعارات البريد الإلكتروني
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancelSettings">إلغاء</button>
                <button type="button" class="btn btn-primary" id="saveSettings">حفظ الإعدادات</button>
            </div>
        </div>
    </div>

    <!-- Floating Action Button -->
    <button class="fab" id="createTaskFab">
        <i class="fas fa-plus"></i>
    </button>

    <!-- JavaScript -->
    <script src="autopilot-dashboard.js"></script>
    <script>
      // Initialize persisted theme
      (function(){
        try {
          const saved = localStorage.getItem('auraos:theme');
          if (saved === 'dark') {
            document.documentElement.classList.add('dark');
          }
        } catch (e) {}
      })();
    </script>
</body>
</html>
